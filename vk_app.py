import streamlit as st
import openpyxl
import pandas as pd
import numpy as np
import plotly.express as px
import re
import requests
import time
from collections import Counter

VK_THEME2SEGMENT = {
    "dj": "–ú—É–∑—ã–∫–∞",
    "r&b": "–ú—É–∑—ã–∫–∞",
    "rap, hip-hop": "–ú—É–∑—ã–∫–∞",
    "–∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "–∞–≤—Ç–æ–≤–ª–∞–¥–µ–ª—å—Ü—ã": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–∞–≤—Ç–æ–º–æ–±–∏–ª–∏": "–ê–≤—Ç–æ, –º–æ—Ç–æ",
    "–∞–≤—Ç–æ–º–æ–π–∫–∞": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–∞–≤—Ç–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–∞–≤—Ç–æ—Å–∞–ª–æ–Ω": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "–∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–∞–≤—Ç–æ—Å–ø–æ—Ä—Ç": "–°–ø–æ—Ä—Ç",
    "–∞–≤—Ç–æ—Ç–æ–≤–∞—Ä—ã": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–∞–≤—Ç–æ—à–∫–æ–ª–∞": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–∞–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã": "–ê–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã",
    "–∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "–∞–∫—Ç—Ä–∏—Å–∞": "–ö–∏–Ω–æ",
    "–∞–∫—Ç—ë—Ä": "–ö–∏–Ω–æ",
    "–∞–∫—Ç—ë—Ä –∏–ª–∏ –∞–∫—Ç—Ä–∏—Å–∞": "–ö–∏–Ω–æ",
    "–∞–ª—å–±–æ–º": "–ú—É–∑—ã–∫–∞",
    "–∞–Ω–∏–º–∞—Ü–∏—è": "–ö–∏–Ω–æ",
    "–∞–Ω—Ç–∏–∫–≤–∞—Ä–∏–∞—Ç": "–ê–Ω—Ç–∏–∫–≤–∞—Ä–∏–∞—Ç",
    "–∞–ø—Ç–µ–∫–∞, –æ–ø—Ç–∏–∫–∞": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "–∞—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–∞—Å—Ç—Ä–æ–ª–æ–≥–∏—è, —ç–∑–æ—Ç–µ—Ä–∏–∫–∞": "–ê—Å—Ç—Ä–æ–ª–æ–≥–∏—è –∏ —ç–∑–æ—Ç–µ—Ä–∏–∫–∞",
    "–±–∞–∑–∞ –æ—Ç–¥—ã—Ö–∞": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "–±–∞–Ω–∫, —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "–±–∞—Ä, –ø–∞–±": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "–±–∞—Å–∫–µ—Ç–±–æ–ª": "–°–ø–æ—Ä—Ç",
    "–±–∞—Å–∫–µ—Ç–±–æ–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞": "–°–ø–æ—Ä—Ç",
    "–±–∞—Å—Å–µ–π–Ω": "–°–ø–æ—Ä—Ç",
    "–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": "–†–∞–∑–Ω–æ–µ",
    "–±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å, —Ä–æ–¥—ã": "–°–µ–º—å—è, –¥–µ—Ç–∏",
    "–±–∏–∞—Ç–ª–æ–Ω–∏—Å—Ç–∫–∞": "–°–ø–æ—Ä—Ç",
    "–±–∏–±–ª–∏–æ—Ç–µ–∫–∞": "–ö–Ω–∏–≥–∏",
    "–±–∏–∑–Ω–µ—Å": "–ë–∏–∑–Ω–µ—Å –∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ",
    "–±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è": "–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
    "–±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å": "–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
    "–±–ª–æ–≥": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
    "–±–ª–æ–≥–µ—Ä": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
    "–±–ª—é–∑": "–ú—É–∑—ã–∫–∞",
    "–±–æ–µ–≤—ã–µ –∏—Å–∫—É—Å—Å—Ç–≤–∞": "–°–ø–æ—Ä—Ç",
    "–±–æ–ª—å–Ω–∏—Ü–∞": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "–±—É—Ç–∏–∫": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "–±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–≤–µ–±-—Å—Ç—É–¥–∏—è": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–≤–µ–¥—É—â–∞—è": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
    "–≤–µ–¥—É—â–∏–π": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
    "–≤–µ–ª–æ—Å–∏–ø–µ–¥—ã": "–°–ø–æ—Ä—Ç",
    "–≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∏–Ω–∏–∫–∞": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "–≤–∏–¥–µ–æ–∏–≥—Ä–∞": "–í–∏–¥–µ–æ–∏–≥—Ä—ã",
    "–≤–∏–¥–µ–æ–∏–≥—Ä—ã": "–í–∏–¥–µ–æ–∏–≥—Ä—ã",
    "–≤–∫–æ–Ω—Ç–∞–∫—Ç–µ": "–°–æ—Ü—Å–µ—Ç–∏",
    "–≤–æ–¥–Ω—ã–π —Å–ø–æ—Ä—Ç": "–°–ø–æ—Ä—Ç",
    "–≤–æ–¥–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç": "–°–ø–æ—Ä—Ç",
    "–≤–æ–µ–Ω–Ω–æ–µ –¥–µ–ª–æ": "–ú–∏–ª–∏—Ç–∞—Ä–∏–∑–º",
    "–≤—Ä–∞—á": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "–≤—ã–º—ã—à–ª–µ–Ω–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
    "–≤—ã—Å–æ–∫–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–≥–∞–ª–µ—Ä–µ—è": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–≥–∏–º–Ω–∞–∑–∏—è": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–≥–∏–ø–µ—Ä–º–∞—Ä–∫–µ—Ç": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "–≥–æ—Ä–æ–¥—Å–∫–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ": "–û–±—â–µ—Å—Ç–≤–æ",
    "–≥–æ—Å—Ç–∏–Ω–∏—Ü–∞": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è": "–û–±—â–µ—Å—Ç–≤–æ",
    "–≥—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–∫–∏": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–≥—Ä—É–ø–ø–∞ –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–≥—Ä—É–ø–ø–∞ –∫–æ–ª–ª–µ–≥": "–û–±—â–µ–Ω–∏–µ –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞",
    "–≥—Ä—É–ø–ø–∞ –ø–∞–º—è—Ç–∏": "–û–±—â–µ–Ω–∏–µ –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞",
    "–≥—Ä—É–ø–ø–∞ —Å–æ–∫—É—Ä—Å–Ω–∏–∫–æ–≤": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–¥–µ—Ç—Å–∫–∞—è –æ–¥–µ–∂–¥–∞ –∏ –æ–±—É–≤—å": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "–¥–µ—Ç—Å–∫–∏–π —Å–∞–¥": "–°–µ–º—å—è, –¥–µ—Ç–∏",
    "–¥–µ—Ç—Å–∫–æ–µ –ø–∏—Ç–∞–Ω–∏–µ": "–°–µ–º—å—è, –¥–µ—Ç–∏",
    "–¥–∂–∞–∑": "–ú—É–∑—ã–∫–∞",
    "–¥–∏–µ—Ç—ã, –∑–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "–¥–∏–∑–∞–π–Ω –∏ –≥—Ä–∞—Ñ–∏–∫–∞": "–î–∏–∑–∞–π–Ω",
    "–¥–∏–∑–∞–π–Ω –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞": "–î–∏–∑–∞–π–Ω",
    "–¥–∏–∑–∞–π–Ω-—Å—Ç—É–¥–∏—è": "–î–∏–∑–∞–π–Ω",
    "–¥–∏–∑–∞–π–Ω–µ—Ä": "–î–∏–∑–∞–π–Ω",
    "–¥–∏—Å–∫—É—Å—Å–∏–æ–Ω–Ω—ã–π –∫–ª—É–±": "–û–±—â–µ—Å—Ç–≤–æ",
    "–¥–æ–º –∫—É–ª—å—Ç—É—Ä—ã": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–¥–æ–º–∞—à–Ω–∏–µ –∏ –¥–∏–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ": "–ñ–∏–≤–æ—Ç–Ω—ã–µ",
    "–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–¥–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "–¥—Ä—É–≥–∞—è –º—É–∑—ã–∫–∞": "–ú—É–∑—ã–∫–∞",
    "–¥—Ä—É–≥–∏–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞": "–°–ø–æ—Ä—Ç",
    "–¥—Ä—É–≥–∏–µ —Ç–æ–≤–∞—Ä—ã": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "–¥—Ä—É–≥–∏–µ —É—Å–ª—É–≥–∏": "–£—Å–ª—É–≥–∏",
    "–¥—Ä—É–≥–∏–µ —Ö–æ–±–±–∏": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "–¥—Ä—É–∑—å—è": "–†–∞–∑–Ω–æ–µ",
    "–¥—É—Ö–æ–≤–Ω–æ–µ –ª–∏—Ü–æ": "–†–µ–ª–∏–≥–∏—è –∏ –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å",
    "–µ–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "–∂—É—Ä–Ω–∞–ª–∏—Å—Ç": "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞",
    "–∂—É—Ä–Ω–∞–ª–∏—Å—Ç –∏–ª–∏ –∂—É—Ä–Ω–∞–ª–∏—Å—Ç–∫–∞": "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞",
    "–∂—É—Ä–Ω–∞–ª–∏—Å—Ç–∫–∞": "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞",
    "–∑–∞–∫—Ä—ã—Ç–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ": "–û–±—â–µ—Å—Ç–≤–æ",
    "–∑–≤—É–∫–æ–∑–∞–ø–∏—Å—å": "–ú—É–∑—ã–∫–∞",
    "–∑–¥–æ—Ä–æ–≤—ã–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏": "–ö—Ä–∞—Å–æ—Ç–∞, –∑–¥–æ—Ä–æ–≤—å–µ",
    "–∑–∏–º–Ω–∏–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞": "–°–ø–æ—Ä—Ç",
    "–∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞": "–û–±—â–µ–Ω–∏–µ –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞",
    "–∑–æ–æ–º–∞–≥–∞–∑–∏–Ω": "–ñ–∏–≤–æ—Ç–Ω—ã–µ",
    "–∑–æ–æ–ø–∞—Ä–∫": "–ñ–∏–≤–æ—Ç–Ω—ã–µ",
    "–∏–≥—Ä–∞": "–í–∏–¥–µ–æ–∏–≥—Ä—ã",
    "–∏–≥—Ä–æ–≤–∞—è —Å—Ç—É–¥–∏—è": "–í–∏–¥–µ–æ–∏–≥—Ä—ã",
    "–∏–≥—Ä—ã": "–í–∏–¥–µ–æ–∏–≥—Ä—ã",
    "–∏–≥—Ä—ã, –∏–≥—Ä—É—à–∫–∏": "–°–µ–º—å—è, –¥–µ—Ç–∏",
    "–∏–∑–¥–∞—Ç–µ–ª—å—Å–∫–∏–π –¥–æ–º": "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞",
    "–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "–∏–Ω–¥–∏": "–ú—É–∑—ã–∫–∞",
    "–∏–Ω—Å—Ç–∏—Ç—É—Ç": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–º–∏": "–°–ú–ò",
    "–∏–Ω—Ç–µ—Ä—å–µ—Ä": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–æ—Ä—Ç–∞–ª": "–†–∞–∑–Ω–æ–µ",
    "–∏—Å–∫—É—Å—Å—Ç–≤–æ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "–∏—Å—Ç–æ—Ä–∏—è": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–∫–∞—Ñ–µ": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "–∫–∞—Ñ–µ, —Ä–µ—Å—Ç–æ—Ä–∞–Ω": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "–∫–≤–µ—Å—Ç": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "–∫–∏–±–µ—Ä—Å–ø–æ—Ä—Ç": "–°–ø–æ—Ä—Ç",
    "–∫–∏–±–µ—Ä—Å–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞": "–°–ø–æ—Ä—Ç",
    "–∫–∏–±–µ—Ä—Å–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è": "–°–ø–æ—Ä—Ç",
    "–∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ": "–ö–∏–Ω–æ",
    "–∫–∏–Ω–æ": "–ö–∏–Ω–æ",
    "–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä": "–ö–∏–Ω–æ",
    "–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –º—É–∑—ã–∫–∞": "–ú—É–∑—ã–∫–∞",
    "–∫–ª–∏–Ω–∏–∫–∞": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "–∫–ª—É–±": "–û–±—â–µ–Ω–∏–µ –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞",
    "–∫–Ω–∏–≥–∞": "–ö–Ω–∏–≥–∏",
    "–∫–Ω–∏–∂–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω": "–ö–Ω–∏–≥–∏",
    "–∫–æ–ª–ª–µ–¥–∂": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–∫–æ–º–∏–∫": "–Æ–º–æ—Ä",
    "–∫–æ–º–ø–∞–Ω–∏—è": "–ë–∏–∑–Ω–µ—Å –∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ",
    "–∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä": "–ú—É–∑—ã–∫–∞",
    "–∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥, –±–∏–∑–Ω–µ—Å-—É—Å–ª—É–≥–∏": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "–∫–æ–Ω—Ü–µ—Ä—Ç": "–ú—É–∑—ã–∫–∞",
    "–∫–æ–Ω—Ü–µ—Ä—Ç–Ω—ã–π –∑–∞–ª": "–ú—É–∑—ã–∫–∞",
    "–∫–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è": "–ö—Ä–∞—Å–æ—Ç–∞, –∑–¥–æ—Ä–æ–≤—å–µ",
    "–∫–æ—Ñ–µ–π–Ω—è": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "–∫—Ä–∏—Ç–∏–∫": "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞",
    "–∫—É–ª–∏–Ω–∞—Ä–∏—è": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "–∫—É–ª–∏–Ω–∞—Ä–∏—è, —Ä–µ—Ü–µ–ø—Ç—ã": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "–∫—É–ª—å—Ç—É—Ä–∞": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–∫—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–∫—É–ª—å—Ç—É—Ä–Ω—ã–π —Ü–µ–Ω—Ç—Ä": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–∫—É—Ä—Å—ã": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–ª–∞—Ç–∏–Ω–æ–∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∞—è –º—É–∑—ã–∫–∞": "–ú—É–∑—ã–∫–∞",
    "–ª–µ—Ç–Ω–∏–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞": "–°–ø–æ—Ä—Ç",
    "–ª–µ—Ç–Ω–∏–π –ª–∞–≥–µ—Ä—å": "–°–µ–º—å—è, –¥–µ—Ç–∏",
    "–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–ª—ë–≥–∫–∞—è –∞—Ç–ª–µ—Ç–∏–∫–∞": "–°–ø–æ—Ä—Ç",
    "–º–∞–≥–∞–∑–∏–Ω": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "–º–µ–±–µ–ª—å": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "–º–µ–¥–∏—Ü–∏–Ω–∞": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —É—Å–ª—É–≥–∞": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "–º–µ—Å—Ç–æ –æ—Ç–¥—ã—Ö–∞": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "–º–µ—Ç–∞–ª": "–º—É–∑—ã–∫–∞",
    "–º–æ–±–∏–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–º–æ–¥–µ–ª—å": "–ú–æ–¥–∞ –∏ —Å—Ç–∏–ª—å",
    "–º–æ–¥–µ–ª—å–Ω–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ": "–ú–æ–¥–∞ –∏ —Å—Ç–∏–ª—å",
    "–º–æ–ª–æ–¥—ë–∂–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ": "–û–±—â–µ—Å—Ç–≤–æ",
    "–º–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–º–æ—Ç–æ—Ü–∏–∫–ª—ã –∏ –¥—Ä—É–≥–∞—è –º–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "–º—É–∑–µ–π, –≥–∞–ª–µ—Ä–µ—è, –≤—ã—Å—Ç–∞–≤–∫–∞": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–º—É–∑—ã–∫–∞": "–ú—É–∑—ã–∫–∞",
    "–º—É–∑—ã–∫–∞–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞": "–ú—É–∑—ã–∫–∞",
    "–º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã": "–ú—É–∑—ã–∫–∞",
    "–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ª–µ–π–±–ª": "–ú—É–∑—ã–∫–∞",
    "–º—É–∑—ã–∫–∞–Ω—Ç": "–ú—É–∑—ã–∫–∞",
    "–º—É–ª—å—Ç—Ñ–∏–ª—å–º": "–ö–∏–Ω–æ",
    "–Ω–∞—Ä–æ–¥–Ω–∞—è –º—É–∑—ã–∫–∞, —Ñ–æ–ª–∫": "–ú—É–∑—ã–∫–∞",
    "–Ω–∞—Å—Ç–æ–ª—å–Ω—ã–µ –∏–≥—Ä—ã": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "–Ω–∞—É–∫–∞": "–ù–∞—É–∫–∞ –∏ –∫–æ—Å–º–æ—Å",
    "–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å": "–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å",
    "–Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è": "–û–±—â–µ—Å—Ç–≤–æ",
    "–Ω–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ç–æ—Ä–∞": "–£—Å–ª—É–≥–∏",
    "–Ω–æ—á–Ω–æ–π –∫–ª—É–±": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "–æ–±–º–µ–Ω –º—É–∑—ã–∫–æ–π": "–ú—É–∑—ã–∫–∞",
    "–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ": "–†–∞–∑–Ω–æ–µ",
    "–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–æ–±—É—á–∞—é—â–∏–µ –∫—É—Ä—Å—ã": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è": "–û–±—â–µ—Å—Ç–≤–æ",
    "–æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ": "–û–±—â–µ—Å—Ç–≤–æ",
    "–æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–µ—è—Ç–µ–ª—å": "–û–±—â–µ—Å—Ç–≤–æ",
    "–æ–±—â–µ—Å—Ç–≤–æ": "–û–±—â–µ—Å—Ç–≤–æ",
    "–æ–±—ä—è–≤–ª–µ–Ω–∏—è": "–†–∞–∑–Ω–æ–µ",
    "–æ–¥–µ–∂–¥–∞, –æ–±—É–≤—å": "–ú–æ–¥–∞ –∏ —Å—Ç–∏–ª—å",
    "–æ–Ω–ª–∞–π–Ω-–∏–≥—Ä–∞": "–í–∏–¥–µ–æ–∏–≥—Ä—ã",
    "–æ–ø–µ—Ä–∞—Ç–æ—Ä –º–æ–±–∏–ª—å–Ω–æ–π —Å–≤—è–∑–∏": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è": "–û–±—â–µ—Å—Ç–≤–æ",
    "–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤": "–ü—Ä–∞–∑–¥–Ω–∏–∫–∏ –∏ —Å–æ–±—ã—Ç–∏—è",
    "–æ—Ç–¥—ã—Ö –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "–æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ–ª–æ–≤": "–ó–Ω–∞–∫–æ–º—Å—Ç–≤–∞",
    "–æ—Ö–æ—Ç–∞ –∏ —Ä—ã–±–∞–ª–∫–∞": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "–ø–∞—Ä–∫ –æ—Ç–¥—ã—Ö–∞": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "–ø–∞—Ä–∫ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "–ø–∞—Ä—Ñ—é–º–µ—Ä–∏—è, –∫–æ—Å–º–µ—Ç–∏–∫–∞": "–ö—Ä–∞—Å–æ—Ç–∞, –∑–¥–æ—Ä–æ–≤—å–µ",
    "–ø–∞—Å—Å–∞–∂–∏—Ä—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–∑–∫–∏": "–£—Å–ª—É–≥–∏",
    "–ø–µ–≤–µ—Ü": "–ú—É–∑—ã–∫–∞",
    "–ø–µ–≤–µ—Ü –∏–ª–∏ –ø–µ–≤–∏—Ü–∞": "–ú—É–∑—ã–∫–∞",
    "–ø–µ–≤–∏—Ü–∞": "–ú—É–∑—ã–∫–∞",
    "–ø–µ—Ä—Å–æ–Ω–∞–∂": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
    "–ø–µ—á–∞—Ç–Ω–æ–µ –∏–∑–¥–∞–Ω–∏–µ": "–°–ú–ò –∏ –∂—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞",
    "–ø–µ—á–∞—Ç—å, –ø–æ–ª–∏–≥—Ä–∞—Ñ–∏—è": "–£—Å–ª—É–≥–∏",
    "–ø–∏—Å–∞—Ç–µ–ª—å": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–ø–∏—Å–∞—Ç–µ–ª—å –∏–ª–∏ –ø–∏—Å–∞—Ç–µ–ª—å–Ω–∏—Ü–∞": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∏—Ü–∞": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–ø–ª–∞—Ç—ë–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞": "–†–∞–∑–Ω–æ–µ",
    "–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–≤–∞–¥—å–±–µ": "–ü—Ä–∞–∑–¥–Ω–∏–∫–∏ –∏ —Å–æ–±—ã—Ç–∏—è",
    "–ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç—ã": "–§–∏–Ω–∞–Ω—Å—ã –∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ",
    "–ø–æ–∫—É–ø–∫–∏": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "–ø–æ–ª–∏—Ç–∏–∫": "–ü–æ–ª–∏—Ç–∏–∫–∞ –∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ",
    "–ø–æ–ª–∏—Ç–∏–∫, –≥–æ—Å—Å–ª—É–∂–∞—â–∏–π": "–ü–æ–ª–∏—Ç–∏–∫–∞ –∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ",
    "–ø–æ–ª–∏—Ç–∏–∫–∞": "–ü–æ–ª–∏—Ç–∏–∫–∞ –∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ",
    "–ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–∞—Ä—Ç–∏—è": "–ü–æ–ª–∏—Ç–∏–∫–∞ –∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ",
    "–ø–æ—á—Ç–æ–≤–∞—è —Å–ª—É–∂–±–∞": "–£—Å–ª—É–≥–∏",
    "–ø–æ—à–∏–≤ –∏ —Ä–µ–º–æ–Ω—Ç –æ–¥–µ–∂–¥—ã": "–£—Å–ª—É–≥–∏",
    "–ø–æ—ç—Ç": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–ø–æ—ç—Ç –∏–ª–∏ –ø–æ—ç—Ç–µ—Å—Å–∞": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–ø–æ—ç—Ç–µ—Å—Å–∞": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –∏–ª–∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å–Ω–∏—Ü–∞": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å–Ω–∏—Ü–∞": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "–ø—Ä–æ–¥–∞–∂–∞ –±–∏–ª–µ—Ç–æ–≤, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–æ—Å—Ç–∏–Ω–∏—Ü": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "–ø—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è, –Ω–∞–ø–∏—Ç–∫–∏": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞": "–£—Å–ª—É–≥–∏",
    "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ, –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å": "–†–∞–∑–Ω–æ–µ",
    "–ø—Ä–æ–∫–∞—Ç": "–ú—É–∑—ã–∫–∞",
    "–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É—á–∏–ª–∏—â–µ": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏": "–£—Å–ª—É–≥–∏",
    "–ø—Å–∏—Ö–æ–ª–æ–≥": "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è –∏ —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ",
    "–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è": "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è –∏ —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ",
    "–ø—É–±–ª–∏—Ü–∏—Å—Ç": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "–ø—É–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞": "–°–ú–ò",
    "—Ä–∞–¥–∏–æ—Å—Ç–∞–Ω—Ü–∏—è": "–ú—É–∑—ã–∫–∞",
    "—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "—Ä–µ–∂–∏—Å—Å—ë—Ä": "–ö–∏–Ω–æ",
    "—Ä–µ–∂–∏—Å—Å—ë—Ä, –ø—Ä–æ–¥—é—Å–µ—Ä": "–ö–∏–Ω–æ",
    "—Ä–µ–∫–ª–∞–º–∞": "–£—Å–ª—É–≥–∏",
    "—Ä–µ–ª–∏–≥–∏–æ–∑–Ω–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ": "–†–µ–ª–∏–≥–∏—è –∏ –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å",
    "—Ä–µ–ª–∏–≥–∏—è": "–†–µ–ª–∏–≥–∏—è –∏ –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å",
    "—Ä–µ–º–æ–Ω—Ç–Ω–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "—Ä–µ—Å—Ç–æ—Ä–∞–Ω": "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏",
    "—Ä–æ–¥–∏—Ç–µ–ª–∏ –∏ –¥–µ—Ç–∏": "–°–µ–º—å—è, –¥–µ—Ç–∏",
    "—Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏": "–û–±—â–µ—Å—Ç–≤–æ",
    "—Ä–æ–∫": "–ú—É–∑—ã–∫–∞",
    "—Ä–æ–ª–µ–≤—ã–µ –∏–≥—Ä—ã": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "—Ä–æ–ª–∏–∫–∏": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "—Ä—ã–±–∞–ª–∫–∞": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "—Å–∞–¥–æ–≤–æ–¥—Å—Ç–≤–æ": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "—Å–∞–π—Ç": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "—Å–∞–π—Ç—ã": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "—Å–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã": "–ö—Ä–∞—Å–æ—Ç–∞, –∑–¥–æ—Ä–æ–≤—å–µ",
    "—Å–∞–ª–æ–Ω—ã —Å–æ—Ç–æ–≤–æ–π —Å–≤—è–∑–∏": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—Å–∞–Ω–∞—Ç–æ—Ä–∏–π, –¥–æ–º –æ—Ç–¥—ã—Ö–∞": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "—Å–≤–∞–¥–µ–±–Ω—ã–π —Å–∞–ª–æ–Ω": "–ü—Ä–∞–∑–¥–Ω–∏–∫–∏ –∏ —Å–æ–±—ã—Ç–∏—è",
    "—Å–µ—Ä–∏–∞–ª": "–ö–∏–Ω–æ",
    "—Å–º–∏": "–°–ú–ò –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏",
    "—Å–æ—Å–µ–¥–∏": "–æ–±—â–µ—Å—Ç–≤–æ",
    "—Å–ø–∞-—Å–∞–ª–æ–Ω": "–ö—Ä–∞—Å–æ—Ç–∞, –∑–¥–æ—Ä–æ–≤—å–µ",
    "—Å–ø–µ–∫—Ç–∞–∫–ª—å": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "—Å–ø–æ—Ä—Ç –∏ –∫—Ä–∞—Å–æ—Ç–∞": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –æ–¥–µ–∂–¥–∞ –∏ –æ–±—É–≤—å": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∫–ª—É–±": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç—Å–º–µ–Ω": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç—Å–º–µ–Ω / —Å–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞": "–°–ø–æ—Ä—Ç",
    "—Å–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞": "–°–ø–æ—Ä—Ç",
    "—Å—Ç–∏–ª–∏—Å—Ç, –∏–º–∏–¥–∂–º–µ–π–∫–µ—Ä": "–ú–æ–¥–∞ –∏ —Å—Ç–∏–ª—å",
    "—Å—Ç–∏–ª—å, –º–æ–¥–∞": "–ú–æ–¥–∞ –∏ —Å—Ç–∏–ª—å",
    "—Å—Ç–∏–ª—å, –æ–¥–µ–∂–¥–∞, –æ–±—É–≤—å": "–ú–æ–¥–∞ –∏ —Å—Ç–∏–ª—å",
    "—Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è": "–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ",
    "—Å—Ç—Ä–∞–Ω–∞": "–†–∞–∑–Ω–æ–µ",
    "—Å—Ç—Ä–∏–º–µ—Ä": "–†–∞–∑–Ω–æ–µ",
    "—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –∏ —Ä–µ–º–æ–Ω—Ç–Ω—ã–µ —Ä–∞–±–æ—Ç—ã": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ, —Ä–µ–º–æ–Ω—Ç": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "—Å—Ç—É–¥–∏—è": "–£—Å–ª—É–≥–∏",
    "—Å—Ç—É–¥–∏—è –∑–≤—É–∫–æ–∑–∞–ø–∏—Å–∏": "–ú—É–∑—ã–∫–∞",
    "—Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—Ç–∞–∫—Å–∏": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "—Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω–∞—è –º—É–∑—ã–∫–∞": "–ú—É–∑—ã–∫–∞",
    "—Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω–∞—è —à–∫–æ–ª–∞": "–ú—É–∑—ã–∫–∞",
    "—Ç–∞–Ω—Ü–æ—Ä": "–ú—É–∑—ã–∫–∞",
    "—Ç–∞–Ω—Ü—ã": "–ú—É–∑—ã–∫–∞",
    "—Ç–∞—Ç—É-—Å–∞–ª–æ–Ω": "–£—Å–ª—É–≥–∏",
    "—Ç–≤–æ—Ä—á–µ—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ": "–û–±—â–µ—Å—Ç–≤–æ",
    "—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "—Ç–µ–∞—Ç—Ä": "–ö—É–ª—å—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "—Ç–µ–∫—Å—Ç—ã, –∞–∫–∫–æ—Ä–¥—ã": "–†–∞–∑–Ω–æ–µ",
    "—Ç–µ–ª–µ–∫–∞–Ω–∞–ª": "–°–ú–ò",
    "—Ç–µ–Ω–Ω–∏—Å": "–°–ø–æ—Ä—Ç",
    "—Ç–µ—Ö–Ω–∏–∫–∞, —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "—Ç–æ–≤–∞—Ä": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—Ç–æ–≤–∞—Ä—ã –¥–ª—è –¥–∞—á–∏, –æ–≥–æ—Ä–æ–¥–∞": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "—Ç–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π": "–°–µ–º—å—è –∏ –¥–µ—Ç–∏",
    "—Ç–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "—Ç–æ–≤–∞—Ä—ã –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö": "–ñ–∏–≤–æ—Ç–Ω—ã–µ",
    "—Ç–æ–≤–∞—Ä—ã –¥–ª—è –æ—Ñ–∏—Å–∞": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—Ç–æ–≤–∞—Ä—ã –¥–ª—è –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤": "–ü—Ä–∞–∑–¥–Ω–∏–∫–∏ –∏ —Å–æ–±—ã—Ç–∏—è",
    "—Ç–æ–≤–∞—Ä—ã –¥–ª—è —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—Ç–æ—Ä–≥–æ–≤–æ-—Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π —Ü–µ–Ω—Ç—Ä": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—Ç–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç": "–ê–≤—Ç–æ, –º–æ—Ç–æ",
    "—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏": "–£—Å–ª—É–≥–∏",
    "—Ç—Ä–µ–Ω–∏–Ω–≥, —Å–µ–º–∏–Ω–∞—Ä": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "—Ç—É—Ä–∞–≥–µ–Ω—Ç—Å—Ç–≤–æ": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "—Ç—É—Ä–∏–∑–º": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "—Ç—É—Ä–∏–∑–º –∏ –æ—Ç–¥—ã—Ö": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "—Ç—É—Ä–∏–∑–º, –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è": "–¢—É—Ä–∏–∑–º –∏ –æ—Ç–¥—ã—Ö",
    "—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ": "–†–∞–∑–Ω–æ–µ",
    "—Ç—É—Ä—ã, —ç–∫—Å–∫—É—Ä—Å–∏–∏": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "—É–∫—Ä–∞—à–µ–Ω–∏—è, –±–∏–∂—É—Ç–µ—Ä–∏—è": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—Å–∫–∏–π —Å–ø–æ—Ä—Ç": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "—É–ø—Ä–∞–≤–ª—è—é—â–∞—è –∫–æ–º–ø–∞–Ω–∏—è": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "—É—Å–ª—É–≥–∞": "–£—Å–ª—É–≥–∏",
    "—É—Å–ª—É–≥–∏ –¥–ª—è –∞–≤—Ç–æ–≤–ª–∞–¥–µ–ª—å—Ü–µ–≤": "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ",
    "—É—Å–ª—É–≥–∏ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∂–∏–≤–æ—Ç–Ω—ã—Ö": "–ñ–∏–≤–æ—Ç–Ω—ã–µ",
    "—É—Ö–æ–¥ –∑–∞ —Å–æ–±–æ–π": "–ö—Ä–∞—Å–æ—Ç–∞, –∑–¥–æ—Ä–æ–≤—å–µ",
    "—É—á—ë–Ω—ã–π, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "—Ñ–∞–Ω-—Å–æ–æ–±—â–µ—Å—Ç–≤–æ": "–û–±—â–µ—Å—Ç–≤–æ",
    "—Ñ–µ—Å—Ç–∏–≤–∞–ª—å": "–ü—Ä–∞–∑–¥–Ω–∏–∫–∏ –∏ —Å–æ–±—ã—Ç–∏—è",
    "—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è": "–†–∞–∑–Ω–æ–µ",
    "—Ñ–∏–ª—å–º": "–ö–∏–Ω–æ",
    "—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä—ã–Ω–∫–∏": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "—Ñ–∏–Ω–∞–Ω—Å—ã": "–§–∏–Ω–∞–Ω—Å—ã –∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ",
    "—Ñ–∏—Ç–Ω–µ—Å": "–ö—Ä–∞—Å–æ—Ç–∞, –∑–¥–æ—Ä–æ–≤—å–µ",
    "—Ñ–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä": "–°–ø–æ—Ä—Ç",
    "—Ñ–æ—Ç–æ- –∏ –≤–∏–¥–µ–æ—Å—ä–µ–º–∫–∞": "–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –∏ –≤–∏–¥–µ–æ",
    "—Ñ–æ—Ç–æ- –∏ –≤–∏–¥–µ–æ—Å—ä—ë–º–∫–∞": "–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –∏ –≤–∏–¥–µ–æ",
    "—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ": "–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –∏ –≤–∏–¥–µ–æ",
    "—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è": "–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –∏ –≤–∏–¥–µ–æ",
    "—Ñ—É—Ç–±–æ–ª": "–°–ø–æ—Ä—Ç",
    "—Ñ—É—Ç–±–æ–ª–∏—Å—Ç": "–°–ø–æ—Ä—Ç",
    "—Ñ—É—Ç–±–æ–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞": "–°–ø–æ—Ä—Ç",
    "—Ö–∏–º—á–∏—Å—Ç–∫–∞, –ø—Ä–∞—á–µ—á–Ω–∞—è": "–î–æ–º –∏ —Ä–µ–º–æ–Ω—Ç",
    "—Ö–æ–∫–∫–µ–π": "–°–ø–æ—Ä—Ç",
    "—Ö–æ–∫–∫–µ–π–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞": "–°–ø–æ—Ä—Ç",
    "—Ö–æ—Å—Ç–µ–ª": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
    "—Ö–æ—Å—Ç–∏–Ω–≥, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–æ–º–µ–Ω–æ–≤": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "—Ö—Ä–∞–º": "–†–µ–ª–∏–≥–∏—è –∏ –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å",
    "—Ö—É–¥–æ–∂–Ω–∏–∫": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "—Ö—É–¥–æ–∂–Ω–∏–∫ –∏–ª–∏ —Ö—É–¥–æ–∂–Ω–∏—Ü–∞": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "—Ö—É–¥–æ–∂–Ω–∏—Ü–∞": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ",
    "—Ü–≤–µ—Ç—ã": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—Ü–∏—Ä–∫": "–•–æ–±–±–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
    "—á–∞—Å—ã": "–ú–æ–¥–∞ –∏ —Å—Ç–∏–ª—å",
    "—à–∫–æ–ª–∞": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
    "—à–æ—É": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
    "—à–æ—É, –ø–µ—Ä–µ–¥–∞—á–∞": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
    "—à–æ—É-–±–∏–∑–Ω–µ—Å": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "—ç–∫–æ–Ω–æ–º–∏–∫–∞ –∏ —Ñ–∏–Ω–∞–Ω—Å—ã": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
    "—ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–π —Å–ø–æ—Ä—Ç": "–°–ø–æ—Ä—Ç",
    "—ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞": "IT –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
    "—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –º—É–∑—ã–∫–∞": "–ú—É–∑—ã–∫–∞",
    "—ç—Ä–æ—Ç–∏–∫–∞": "–†–∞–∑–Ω–æ–µ",
    "—é–≤–µ–ª–∏—Ä–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è": "–¢–æ—Ä–≥–æ–≤–ª—è –∏ –º–∞–≥–∞–∑–∏–Ω—ã",
    "—é–º–æ—Ä": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
    "—é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —É—Å–ª—É–≥–∏": "–£—Å–ª—É–≥–∏",
    "—è–∑—ã–∫–∏": "–†–∞–∑–Ω–æ–µ",
    }

# --- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
st.set_page_config(page_title="VK –ê–Ω–∞–ª–∏–∑", layout="wide")
st.title("VK –ê–Ω–∞–ª–∏–∑: –°–±–æ—Ä –∏ –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ñ–∏–ª–µ–π –í–ö–æ–Ω—Ç–∞–∫—Ç–µ")

# --- –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞ ---
def define_segment(groups):
    if not groups:
        return np.nan
    mapped = [
        VK_THEME2SEGMENT.get(str(g.get("theme", "")).lower().strip())
        for g in groups if g.get("theme")
    ]
    mapped = [m for m in mapped if m]
    return Counter(mapped).most_common(1)[0][0] if mapped else np.nan

# --- –ó–∞–≥—Ä—É–∑–∫–∞ ID-—Ñ–∞–π–ª–∞ ---
uploaded = st.sidebar.file_uploader("–ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Å user_id", type=["csv"])

st.sidebar.markdown("""
### ‚ÑπÔ∏è –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- –ó–∞–≥—Ä—É–∂–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –í–≤–µ–¥–∏—Ç–µ VK API —Ç–æ–∫–µ–Ω
- –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ API: `users.get`, `groups.get`
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –±–æ—Ç–æ–≤ –∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã
""")

if uploaded:
    df = pd.read_csv(uploaded)
    id_col = "VK ID"
    ids = df[id_col].astype(int).tolist()

    vk_token = st.sidebar.text_input("–í–≤–µ–¥–∏—Ç–µ VK API —Ç–æ–∫–µ–Ω", type="password")
    if vk_token and st.sidebar.button("–°–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ VK API"):
        import requests, time

        BASE_URL = 'https://api.vk.com/method/'
        API_VERSION = '5.199'
        results = []
        users_chunks = [ids[i:i+100] for i in range(0, len(ids), 100)]

        progress_bar = st.progress(0, text="‚è≥ –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ VK API...")
        
        for idx, chunk in enumerate(users_chunks):
            st.write(f"üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π {idx*100+1}-{idx*100+len(chunk)}")
            users_resp = requests.get(BASE_URL + 'users.get', params={
                'user_ids': ','.join(map(str, chunk)),
                'fields': 'activities,bdate,city,country,education,last_seen,occupation,sex,universities',
                'access_token': vk_token,
                'v': API_VERSION
            }).json()
        
            for user in users_resp.get("response", []):
                try:
                    user_result = {
                        "first_name": user.get("first_name"),
                        "last_name": user.get("last_name"),
                        "activities": user.get("activities"),
                        "bdate": user.get("bdate"),
                        "city": user.get("city", {}).get("title") if isinstance(user.get("city"), dict) else None,
                        "country": user.get("country", {}).get("title") if isinstance(user.get("country"), dict) else None,
                        "university_name": user.get("education", {}).get("university_name") if isinstance(user.get("education"), dict) else None,
                        "faculty_name": user.get("education", {}).get("faculty_name") if isinstance(user.get("education"), dict) else None,
                        "last_seen_time": user.get("last_seen", {}).get("time") if isinstance(user.get("last_seen"), dict) else None,
                        "occupation_type": user.get("occupation", {}).get("type") if isinstance(user.get("occupation"), dict) else None,
                        "sex": user.get("sex"),
                        "faculty_from_universities": (
                            user["universities"][0].get("faculty_name")
                            if isinstance(user.get("universities"), list) and len(user["universities"]) > 0
                            else None
                        ),
                        "VK ID": user.get("id"),
                    }
        
                    # groups.get –∑–∞–ø—Ä–æ—Å
                    resp = requests.get(BASE_URL + 'groups.get', params={
                        'user_id': user.get("id"),
                        'access_token': vk_token,
                        'v': API_VERSION,
                        'extended': 1,
                        'fields': 'activity',
                        'count': 1000
                    })
                    groups_data = resp.json()
        
                    if "response" in groups_data:
                        groups = groups_data["response"]["items"]
                        user_result["group_count"] = len(groups)
                        for j, group in enumerate(groups[:50], start=1):
                            user_result[f"group_{j}_name"] = group.get("name", "")
                            user_result[f"group_{j}_activity"] = group.get("activity", "")
                        results.append(user_result)
        
                except Exception:
                    pass
        
            progress_bar.progress((idx + 1) / len(users_chunks), text=f"‚è≥ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ {idx + 1} –∏–∑ {len(users_chunks)} –ø–∞–∫–µ—Ç–æ–≤")
            time.sleep(0.5)
        
        progress_bar.empty()

        df_vk = pd.DataFrame(results)
        df = df.merge(df_vk, on=id_col, how="left")
        st.session_state["df"] = df
        st.success("‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ–±—Ä–∞–Ω—ã –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã!")

if "df" in st.session_state:
    df = st.session_state["df"]

    # --- –º–µ—Ç–∫–∞ "–±–æ—Ç" ---
    df["–í–ò–ó–ò–¢ –í –í–ö"] = pd.to_datetime(df["last_seen_time"], unit="s", errors='coerce')
    first_q = df["group_count"].quantile(0.25)
    bot_thr = df["group_count"].mean() + 2 * df["group_count"].std()
    max_date = df["–í–ò–ó–ò–¢ –í –í–ö"].max()
    days_since = (max_date - df["–í–ò–ó–ò–¢ –í –í–ö"]).dt.days
    df["–¢–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞"] = "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    df.loc[(df["group_count"]<=first_q) | ((df["group_count"]>bot_thr)&(days_since>180)) | (days_since>360), "–¢–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞"] = "–±–æ—Ç"

    # --- —Å–µ–≥–º–µ–Ω—Ç—ã ---
    theme_cols = [c for c in df.columns if re.match(r"group_\d+_activity$", c)]
    df['segment'] = df.apply(
        lambda row: define_segment([
            {"theme": str(row[c]).lower().strip()} for c in theme_cols if pd.notna(row[c]) and str(row[c]).strip()
        ]), axis=1
    )

    # --- —Ñ–∏–ª—å—Ç—Ä—ã ---
    account_filter = st.radio("–ö–æ–≥–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:", ["–í—Å–µ—Ö", "–¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π", "–¢–æ–ª—å–∫–æ –±–æ—Ç–æ–≤"])
    df_plot = df.copy()
    if account_filter == "–¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π":
        df_plot = df_plot[df_plot["–¢–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞"] == "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"]
    elif account_filter == "–¢–æ–ª—å–∫–æ –±–æ—Ç–æ–≤":
        df_plot = df_plot[df_plot["–¢–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞"] == "–±–æ—Ç"]

    segment_options = ["–í—Å–µ"] + sorted(df_plot['segment'].dropna().unique())
    selected_segment = st.selectbox("–§–∏–ª—å—Ç—Ä –ø–æ —Å–µ–≥–º–µ–Ω—Ç—É:", segment_options)
    if selected_segment != "–í—Å–µ":
        df_plot = df_plot[df_plot["segment"] == selected_segment]

    # --- –≤—ã–≤–æ–¥ ---
    st.subheader("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã")
    col1, col2, col3 = st.columns(3)
    col1.metric("–í—Å–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤", len(df))
    col2.metric("–ë–æ—Ç—ã", (df["–¢–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞"] == "–±–æ—Ç").sum())
    col3.metric("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏", (df["–¢–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞"] == "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å").sum())
    st.dataframe(df_plot, use_container_width=True, height=600)

    st.subheader("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
    show_users_only = st.checkbox("–¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –≥—Ä–∞—Ñ–∏–∫–µ", value=True)
    df_graph = df_plot[df_plot["–¢–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞"] == "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"] if show_users_only else df_plot

    segment_counts = df_graph['segment'].fillna("–ù–µ—Ç —Å–µ–≥–º–µ–Ω—Ç–∞").value_counts().sort_values(ascending=False)
    top_n = st.slider("–°–∫–æ–ª—å–∫–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ:", 5, 30, 10)
    df_bar = segment_counts.head(top_n).reset_index()
    df_bar.columns = ["–°–µ–≥–º–µ–Ω—Ç", "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ"]
    fig = px.bar(df_bar, x="–°–µ–≥–º–µ–Ω—Ç", y="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ", title=f"–¢–æ–ø-{top_n} —Å–µ–≥–º–µ–Ω—Ç–æ–≤", height=500)
    st.plotly_chart(fig, use_container_width=True)

    with st.expander("üì¶ –î–µ—Ç–∞–ª–∏ –ø–æ –±–æ—Ç–∞–º"):
        bots = df[df["–¢–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞"] == "–±–æ—Ç"]
        st.write("–°—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ –≥—Ä—É–ø–ø —É –±–æ—Ç–æ–≤:", round(bots['group_count'].mean(), 2))
        st.write("–ë–æ—Ç–æ–≤ —Å –≤–∏–∑–∏—Ç–æ–º –±–æ–ª–µ–µ 360 –¥–Ω–µ–π –Ω–∞–∑–∞–¥:", (days_since > 360).sum())
        bot_segments = bots['segment'].fillna("–ù–µ—Ç —Å–µ–≥–º–µ–Ω—Ç–∞").value_counts().sort_values(ascending=False)
        st.bar_chart(bot_segments)
        st.dataframe(bots)

    # --- –∫–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è ---
    from io import BytesIO
    if st.sidebar.button("–°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç"):
        buffer = BytesIO()
        df_plot.to_excel(buffer, index=False)
        st.download_button("üì• –°–∫–∞—á–∞—Ç—å Excel", buffer.getvalue(), file_name="vk_analysis.xlsx")
else:
    st.info("–ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.")
